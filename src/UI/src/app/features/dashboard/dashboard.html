

<div class="container-xl text-center" id="main-content">

  <div class="row mt-4" id="dashboard-header">

    <div class="row">
      <div class="col-6 align-self-start">
          <a class="text-decoration-none text-black" type="button" routerLink=".">
            <h1>
              Application Dashboard <br>
              <p class="text-body-secondary fs-6 ">Track your job applications and monitor your success rate</p>
            </h1>
          </a>
      </div>

      <div class="col">

        <button type="button" class="btn mt-3 p-1" id="last-updated-button" disabled>
          Last Updated: TDB
        </button>

        <a routerLink="/add-application" class="btn mt-3 ms-4" role="button" id="new-app-btn" >
          + New Application
        </a>


      </div>
    </div>
  </div>



  <div class="row mt-3" id="dashboard-cards">

    <div class="card-group">

      <!-- Total Resumes Card -->
      <div class="card">
        <div class="card-body text-start">
          <div class="row justify-content-between">
            <div class="col-9 align-self-start">
              <h5 class="card-title">Total Applications</h5>
            </div>
            <div class="col-2">
              <i class="fa-regular fa-file"></i>
            </div>
          </div>
          <br>
          <app-application-list></app-application-list>
          <p class="card-text" id="card-detail-section">
            All submitted resumes
          </p>
        </div>
      </div>


      <!-- Accepted Resumes Card -->
      <div class="card">
        <div class="card-body text-start">
          <div class="row justify-content-between">
            <div class="col-8 align-self-start">
              <h5 class="card-title">Accepted</h5>
            </div>
            <div class="col-2">
              <i class="fa-regular fa-circle-check text-success"></i>
            </div>
          </div>
          <br>
          <app-application-list [status]="'ACCEPTED'"></app-application-list>
          <p class="card-text" id="card-detail-section">
            Offer accepted
          </p>
        </div>
      </div>


      <!-- Pending Resumes Card -->
      <div class="card">
        <div class="card-body text-start">
          <div class="row justify-content-between">
            <div class="col-8 align-self-start">
              <h5 class="card-title">Pending</h5>
            </div>
            <div class="col-2">
              <i class="fa-regular fa-clock text-warning"></i>
            </div>
          </div>
          <br>
          <app-application-list [status]="'PENDING'"></app-application-list>
          <p class="card-text" id="card-detail-section">
            Waiting on Response
          </p>
        </div>
      </div>



      <!-- Success Rate Card -->
      <div class="card">
        <div class="card-body text-start">
          <div class="row justify-content-between">
            <div class="col-8 align-self-start">
              <h5 class="card-title">Success Rate</h5>
            </div>
            <div class="col-2">
              <i class="fa-solid fa-check-double text-primary"></i>
            </div>
          </div>
          <br>
          <app-application-list [showRate]="true"></app-application-list>
          <p class="card-text" id="card-detail-section">
            Acceptance percentage
          </p>
        </div>
      </div>

    </div>



  </div>



  <div class="row mt-3" id="dashboard-charts">

    <div class="card-group">

      <div class="card">

      </div>

      <div class="card">

      </div>

      <div class="card">

      </div>

    </div>

  </div>


  <div class="card">
    <div class="row mt-3" id="dashboard-list">

      <h2 class="text-start ms-3" id="application-list-title">List of Applications</h2>

      <div class="card" id="application-list-table">
        <table class="table table-hover">
          <thead>
          <tr>
            <th scope="col">Position</th>
            <th scope="col">Company</th>
            <th scope="col">Status</th>
            <th scope="col">Progress</th>
            <th scope="col">Date Applied</th>
            <th scope="col"></th>
          </tr>
          </thead>
          <tbody class="table-group-divider">
            @if (isLoading) {
              <tr>
                <td colspan="6" class="text-muted">Loading applicationsâ€¦</td>
              </tr>
            }

            @if (error) {
              <tr>
                <td colspan="6" class="text-danger">{{ error }}</td>
              </tr>
            }

            @for (app of applications; track app.id) {
              <tr>
                <td>{{ app.jobTitle }}</td>
                <td>{{ app.company }}</td>
                <td>{{ app.status }}</td>
                <td>
                  <div class="text-start justify-content-center">{{ app.progress + "%" }}</div>
                  <div class="progress" role="progressbar" aria-label="Application progress"
                       aria-valuenow="{{ app.progress || 0 }}" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar" [style.width.%]="app.progress || 0"></div>
                  </div>
                </td>
                <td>{{ app.submissionDate | date:'yyyy-MM-dd' }}</td>
                <td>
                  <div class="dropdown">
                    <button class="btn btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown"
                            aria-expanded="false"></button>
                    <ul class="dropdown-menu">
                      <li><a class="dropdown-item" [routerLink]="['/edit-application', app.id]">Edit</a></li>
                      <li>
                        <button class="dropdown-item text-danger" type="button" (click)="onDelete(app)">Delete</button>
                      </li>
                    </ul>
                  </div>
                </td>
              </tr>
            } @empty {
              <tr>
                <td colspan="6">No applications found</td>
              </tr>
            }

          </tbody>

        </table>
      </div>


    </div>

  </div>

</div>


